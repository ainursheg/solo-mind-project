# Проект "Solo Mind" (v0.3.0-MVP)

**Solo Mind** — это Full-Stack приложение для геймификации саморазвития, вдохновленное манхвой "Solo Leveling". Приложение помогает пользователям превратить рутинные действия по улучшению физических и интеллектуальных навыков в увлекательный игровой процесс с прокачкой персонажа.

---

## 1. Технологический Стек

*   **Frontend:** React, Next.js (App Router), Tailwind CSS, Axios
*   **Backend:** Node.js, Express.js
*   **База данных:** PostgreSQL с Prisma ORM
*   **Внешние API:**
    *   **OCR.space:** для распознавания текста с изображений.
    *   **Groq (Llama 3):** для генерации квизов на основе распознанного текста.

---

## 2. Структура Проекта

Проект представляет собой монорепозиторий с двумя основными частями: `backend` и `frontend`.

```
solo-mind-project/
├── backend/          # Бэкенд-сервер на Express
│   ├── prisma/       # Схема и миграции базы данных
│   ├── services/     # "Чистая" игровая логика (gameMechanicsService.js)
│   └── index.js      # Главный файл сервера
├── frontend/         # Фронтенд-приложение на Next.js
│   └── src/
│       ├── app/      # Страницы и роутинг (App Router)
│       ├── components/ # Переиспользуемые React-компоненты
│       ├── context/  # Глобальные контексты (GameContext.js)
│       └── hooks/    # React-хуки (useAuth.js)
└── README.md         # Этот файл
```

---

## 3. Модель Данных (Архитектура "Накопитель / Витрина")

Мы используем архитектурный паттерн, разделяющий "сырые" данные и "отображаемое" состояние.

*   **`User` (Накопитель):** Хранит вечно накапливающиеся метрики усилий пользователя (`totalMindEffort`, `totalBodyEffort`, `quizzesPassed` и т.д.). Это "сырые" данные о проделанной работе.
*   **`Profile` (Витрина):** Хранит вычисляемое состояние персонажа, которое видит пользователь (`level`, `currentXp`, статы `STR`, `END`, `INT`, `WIS`). Эти данные являются производными от метрик в модели `User`.

Этот подход позволяет гибко менять логику начисления статов и уровней, не затрагивая историю достижений пользователя. Полная схема находится в файле `backend/prisma/schema.prisma`.

---

## 4. API Эндпоинты

### Аутентификация
*   `POST /auth/signup` - Регистрация нового пользователя.
*   `POST /auth/login` - Вход пользователя, возвращает JWT токен.

### Защищенные маршруты (требуют `Authorization: Bearer <token>`)
*   `GET /profile` - Получение полного профиля текущего пользователя (включая данные `User` и `Profile`).
*   `POST /ocr/upload-and-process` - Загрузка изображения, распознавание текста, начисление `MindEffort` и генерация квиза.
*   `POST /activity/submit-quiz` - Отправка ответа на квиз. При успехе увеличивает `quizzesPassed`, пересчитывает `WIS` и блокирует чтение.
*   `POST /activity/exercise` - Запись о выполнении упражнения. Начисляет опыт, пересчитывает статы, проверяет level-up и разблокирует чтение.

---

## 5. Основной Игровой Цикл

Игровой процесс построен на трехфазном цикле, управляемом флагом `isReadingUnlocked` в профиле пользователя.

*   **Фаза 1: Чтение и Генерация Квиза (`isReadingUnlocked: true`)**
    1.  Пользователь загружает изображение с текстом.
    2.  Бэкенд распознает текст, генерирует квиз и возвращает его на фронтенд.

*   **Фаза 2: Прохождение Квиза**
    1.  Пользователь отвечает на вопрос квиза.
    2.  При правильном ответе бэкенд обновляет статы, начисляет прогресс и устанавливает `isReadingUnlocked = false`.

*   **Фаза 3: Физическое Упражнение (`isReadingUnlocked: false`)**
    1.  Интерфейс блокирует чтение и предлагает выполнить упражнение.
    2.  Пользователь вводит количество повторений.
    3.  Бэкенд начисляет "Единый Опыт" (Unity XP), обновляет статы, проверяет повышение уровня и устанавливает `isReadingUnlocked = true`.
    4.  Цикл завершен и готов к новому витку.

---

## 6. Как запустить проект локально

### 1. Настройка Бэкенда:
```bash
# Перейдите в папку бэкенда
cd backend

# Установите зависимости
npm install

# Создайте файл .env по примеру .env.example и заполните его
# (DATABASE_URL, JWT_SECRET, OCR_API_KEY, GROQ_API_KEY)

# Примените миграции базы данных
npx prisma migrate dev

# Запустите сервер разработки
npm run dev
# Сервер будет доступен по адресу http://localhost:3001
```

### 2. Настройка Фронтенда:
```bash
# Перейдите в папку фронтенда
cd frontend

# Установите зависимости
npm install

# Запустите приложение для разработки
npm run dev
# Приложение будет доступно по адресу http://localhost:3000
```